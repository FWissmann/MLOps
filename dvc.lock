schema: '2.0'
stages:
  train:
    cmd: docker run -i --rm --name ludwig_experiment_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/conf/ludwig_experiment,dst=/app/conf --env
      MLFLOW_TRACKING_URI=http://172.17.0.4:5000/ ludwig_experiment:3 experiment --config
      /app/conf/ludwig_conf_sim.yaml --dataset /app/data/03_gx_dataprep/03_dataprep_gx_simdata.parquet
      --output_directory /app/data/04_model_results --mlflow --experiment_name relax
      --model_name simdata
    deps:
    - path: ./conf/ludwig_experiment/ludwig_conf_sim.yaml
      md5: 75aab1c902c617aa0618395095319277
      size: 1144
    - path: ./data/03_gx_dataprep/03_dataprep_gx_simdata.parquet
      md5: f22cc1225bbc83cbc857e7e7155eeb91
      size: 18477
  data_gen:
    cmd: docker run -i --rm --name data_gen_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/data_generator,dst=/app/ data_gen:2
    deps:
    - path: ./src/data_generator/data_gen.py
      md5: 30b22f03db6ebeae9dc946671c548528
      size: 11482
    outs:
    - path: ./data/00_simdata/00_simdata.csv
      md5: 7a9776186e9a84d796108ef0b0d13206
      size: 141744
  data_check:
    cmd: docker run -i --rm --name gx_simdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/gx_datacheck,dst=/app/ gx_simdata:3
    deps:
    - path: ./data/00_simdata/00_simdata.csv
      md5: 7a9776186e9a84d796108ef0b0d13206
      size: 141744
    - path: ./src/gx_datacheck/gx_simdata.py
      md5: 385f821c1af5d4c463f47a3b307790fa
      size: 3239
    outs:
    - path: ./data/01_gx/01_gx_simdata.csv
      md5: 7a9776186e9a84d796108ef0b0d13206
      size: 141744
  data_check_real:
    cmd: docker run -i --rm --name gx_realdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/gx_datacheck,dst=/app/ --env REALDATA_LOG_FILENAME=/app/data/00_rawdata/RTWIBSE_W22/RTWIBSE_W22_log.csv
      --env REALDATA_GRADE_FILENAME=/app/data/00_rawdata/RTWIBSE_W22/RTWIBSE_W22_grades.csv
      gx_realdata:3
    deps:
    - path: ./data/00_rawdata/RTWIBSE_W22
      md5: 1762eeb756acde0c2ca017dbf54e73ca.dir
      size: 1479271
      nfiles: 2
    - path: ./src/gx_datacheck/gx_realdata.py
      md5: 991d30e4bcb89c71888b8645322297c5
      size: 5464
    outs:
    - path: ./data/01_gx/01_gx_realdata_grades.csv
      md5: e8fe422073abf9454a217c48022abe6f
      size: 530
    - path: ./data/01_gx/01_gx_realdata_logs.csv
      md5: 8bf129c757e731bde0258341a20e60c2
      size: 1478741
  data_prep:
    cmd: docker run -i --rm --name dataprep_simdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/dataprep,dst=/app/ dataprep_simdata:4
    deps:
    - path: ./data/01_gx/01_gx_simdata.csv
      md5: 7a9776186e9a84d796108ef0b0d13206
      size: 141744
    - path: ./src/dataprep/dataprep_simdata.py
      md5: 50212f06c1e1a70e896325790eae5a96
      size: 6646
    outs:
    - path: ./data/02_dataprep/02_dataprep_simdata.csv
      md5: 272de739b791bc4e6fcaa6e6e3bef4ba
      size: 2064
  data_prep_real:
    cmd: docker run -i --rm --name dataprep_realdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/dataprep,dst=/app/ dataprep_realdata:3
    deps:
    - path: ./data/01_gx/01_gx_realdata_grades.csv
      md5: e8fe422073abf9454a217c48022abe6f
      size: 530
    - path: ./data/01_gx/01_gx_realdata_logs.csv
      md5: 8bf129c757e731bde0258341a20e60c2
      size: 1478741
    - path: ./src/dataprep/dataprep_realdata.py
      md5: cb92e03cff9b18071373281861929057
      size: 8756
    outs:
    - path: ./data/02_dataprep/02_dataprep_realdata.csv
      md5: 5008eba1b69c8a25f3b593355e5fc063
      size: 6407
  data_prep_gx_real:
    cmd: docker run -i --rm --name dataprep_gx_realdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/gx_dataprep,dst=/app/ dataprep_gx_data:4
    deps:
    - path: ./data/02_dataprep/02_dataprep_realdata.csv
      md5: 5008eba1b69c8a25f3b593355e5fc063
      size: 6407
    - path: ./src/gx_dataprep/gx_data_grouped.py
      md5: ce4f37ebf65daf924a737d1b418a7fed
      size: 2909
    outs:
    - path: ./data/03_gx_dataprep/03_dataprep_gx_realdata.parquet
      md5: b1e9aece54e15910ba8372ba557f0726
      size: 24293
  train_real:
    cmd: docker run -i --rm --name ludwig_experiment_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/conf/ludwig_experiment,dst=/app/conf --env
      MLFLOW_TRACKING_URI=http://172.17.0.4:5000/ ludwig_experiment:3 experiment --config
      /app/conf/ludwig_conf_real.yaml --dataset /app/data/03_gx_dataprep/03_dataprep_gx_realdata.parquet
      --output_directory /app/data/04_model_results --mlflow --experiment_name relax
      --model_name realdata
    deps:
    - path: ./conf/ludwig_experiment/ludwig_conf_real.yaml
      md5: f532c0aacf7d1b9ee846547b68fcb20b
      size: 1377
    - path: ./data/03_gx_dataprep/03_dataprep_gx_realdata.parquet
      md5: b1e9aece54e15910ba8372ba557f0726
      size: 24293
  data_prep_gx:
    cmd: docker run -i --rm --name dataprep_gx_simdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/gx_dataprep,dst=/app/ --env DATAPREP_DATA_FILENAME=/app/data/02_dataprep/02_dataprep_simdata.csv
      --env DATAPREP_GX_DATA_FILENAME=03_dataprep_gx_simdata.parquet dataprep_gx_data:4
    deps:
    - path: ./data/02_dataprep/02_dataprep_simdata.csv
      md5: 272de739b791bc4e6fcaa6e6e3bef4ba
      size: 2064
    - path: ./src/gx_dataprep/gx_data_grouped.py
      md5: ce4f37ebf65daf924a737d1b418a7fed
      size: 2909
    outs:
    - path: ./data/03_gx_dataprep/03_dataprep_gx_simdata.parquet
      md5: f22cc1225bbc83cbc857e7e7155eeb91
      size: 18477
  data_check_test:
    cmd: docker run -i --rm --name gx_testdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/gx_datacheck,dst=/app/ --env REALDATA_LOG_FILENAME=/app/data/00_rawdata/RTWIBStat_SS23/RTWIBStat_SS23_log.csv
      --env 
      REALDATA_GRADE_FILENAME=/app/data/00_rawdata/RTWIBStat_SS23/RTWIBStat_SS23_grades.csv
      --env GX_REALDATA_GRADE_FILENAME=01_gx_testdata_grades.csv --env GX_REALDATA_LOG_FILENAME=01_gx_testdata_logs.csv
      gx_realdata:3
    deps:
    - path: ./data/00_rawdata/RTWIBStat_SS23
      md5: 70106b09ca0236cb9714b442028b6faf.dir
      size: 3237431
      nfiles: 2
    - path: ./src/gx_datacheck/gx_realdata.py
      md5: 991d30e4bcb89c71888b8645322297c5
      size: 5464
    outs:
    - path: ./data/01_gx/01_gx_testdata_grades.csv
      md5: ce527eb967a8780496ef12253bf34050
      size: 30
    - path: ./data/01_gx/01_gx_testdata_logs.csv
      md5: 664adea64de5f8eed6656213b7a59ecd
      size: 3237401
  data_prep_test:
    cmd: docker run -i --rm --name dataprep_testdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/dataprep,dst=/app/ --env GX_REALDATA_FILENAME_LOG=./data/01_gx/01_gx_testdata_logs.csv
      --env GX_REALDATA_FILENAME_GRADES=./data/01_gx/01_gx_testdata_grades.csv --env
      DATAPREP_REALDATA_FILENAME=02_dataprep_testdata.csv  dataprep_realdata:3
    deps:
    - path: ./data/01_gx/01_gx_testdata_grades.csv
      md5: ce527eb967a8780496ef12253bf34050
      size: 30
    - path: ./data/01_gx/01_gx_testdata_logs.csv
      md5: 664adea64de5f8eed6656213b7a59ecd
      size: 3237401
    - path: ./src/dataprep/dataprep_realdata.py
      md5: cb92e03cff9b18071373281861929057
      size: 8756
    outs:
    - path: ./data/02_dataprep/02_dataprep_testdata.csv
      md5: 5dc042e1adfd79058d998928d8b4231b
      size: 6896
  data_prep_gx_test:
    cmd: docker run -i --rm --name dataprep_gx_testdata_single --mount type=bind,src=/home/aml/MLOps/data,dst=/app/data
      --mount type=bind,src=/home/aml/MLOps/src/gx_dataprep,dst=/app/ --env DATAPREP_DATA_FILENAME=/app/data/02_dataprep/02_dataprep_testdata.csv
      --env DATAPREP_GX_DATA_FILENAME=03_dataprep_gx_testdata.parquet dataprep_gx_data:4
    deps:
    - path: ./data/02_dataprep/02_dataprep_testdata.csv
      md5: 5dc042e1adfd79058d998928d8b4231b
      size: 6896
    - path: ./src/gx_dataprep/gx_data_grouped.py
      md5: ce4f37ebf65daf924a737d1b418a7fed
      size: 2909
    outs:
    - path: ./data/03_gx_dataprep/03_dataprep_gx_testdata.parquet
      md5: 707e24df87037e714ac158029b5ca435
      size: 28350
  test:
    cmd: python ./src/monitoring_whylogs/monitoring_whylogs_batch.py
    deps:
    - path: ./data/03_gx_dataprep/03_dataprep_gx_testdata.parquet
      md5: 707e24df87037e714ac158029b5ca435
      size: 28350
    - path: ./src/monitoring_whylogs/monitoring_whylogs_batch.py
      md5: 88a325d16e4d9d14f0d8d1aabe9edef1
      size: 4010
    outs:
    - path: ./data/05_results/05_results.csv
      md5: e5228504f14bdf98cf8d5c737d3fc725
      size: 8777
